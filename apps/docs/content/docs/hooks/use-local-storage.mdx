---
title: useLocalStorage
description: Persist state in localStorage with automatic synchronization
---

import { Callout } from "fumadocs-ui/components/callout"; import { Tab, Tabs } from
"fumadocs-ui/components/tabs";

# useLocalStorage

<div className="flex gap-2 mb-4">
  <span className="px-2 py-1 text-xs bg-secondary rounded-md">
    State Management
  </span>
  <span className="px-2 py-1 text-xs bg-secondary rounded-md">Storage</span>
  <span className="px-2 py-1 text-xs bg-secondary rounded-md">Persistence</span>
</div>

A React hook that persists state in localStorage and automatically synchronizes with the stored
value.

<Callout title="Why Use This Hook?">
  - ✅ **Persistent State** - Survives page refreshes and browser sessions - ✅
  **Type Safe** - Full TypeScript support with generic types - ✅ **Error
  Handling** - Gracefully handles localStorage failures - ✅ **SSR Compatible**
  - Works with server-side rendering - ✅ **Auto Sync** - Automatically syncs
  with localStorage changes
</Callout>

## Installation

Generate this hook in your project:

```bash
react-usekit init
# Select "hooks" → Choose language → Select "useLocalStorage"
```

## Usage

### Basic Example

<Tabs items={['TypeScript', 'JavaScript']}> <Tab value="TypeScript">

```tsx
import { useLocalStorage } from './hooks/useLocalStorage';

function UserPreferences() {
  const [theme, setTheme] = useLocalStorage<'light' | 'dark'>('theme', 'light');

  return (
    <div>
      <p>Current theme: {theme}</p>
      <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>Toggle Theme</button>
    </div>
  );
}
```

</Tab>
<Tab value="JavaScript">
```jsx
import { useLocalStorage } from './hooks/useLocalStorage';

function UserPreferences() { const [theme, setTheme] = useLocalStorage('theme', 'light');

return ( <div> <p>Current theme: {theme}</p> <button onClick={() => setTheme(theme === 'light' ?
'dark' : 'light')}> Toggle Theme </button> </div> ); }

````

</Tab>
</Tabs>

### Complex Data Types

```tsx
interface UserProfile {
  name: string;
  email: string;
  preferences: {
    notifications: boolean;
    newsletter: boolean;
  };
}

function ProfileForm() {
  const [profile, setProfile] = useLocalStorage<UserProfile>("userProfile", {
    name: "",
    email: "",
    preferences: {
      notifications: true,
      newsletter: false,
    },
  });

  const updateProfile = (updates: Partial<UserProfile>) => {
    setProfile((prev) => ({ ...prev, ...updates }));
  };

  return (
    <form>
      <input
        value={profile.name}
        onChange={(e) => updateProfile({ name: e.target.value })}
        placeholder="Your name"
      />
      <input
        value={profile.email}
        onChange={(e) => updateProfile({ email: e.target.value })}
        placeholder="Your email"
      />
      <label>
        <input
          type="checkbox"
          checked={profile.preferences.notifications}
          onChange={(e) =>
            updateProfile({
              preferences: {
                ...profile.preferences,
                notifications: e.target.checked,
              },
            })
          }
        />
        Enable notifications
      </label>
    </form>
  );
}
```

## API Reference

### Parameters

| Parameter      | Type     | Description                             |
| -------------- | -------- | --------------------------------------- |
| `key`          | `string` | The localStorage key to use             |
| `initialValue` | `T`      | Default value if no stored value exists |

### Returns

Returns a tuple `[value, setValue]`:

| Return Value | Type                 | Description                         |
| ------------ | -------------------- | ----------------------------------- |
| `value`      | `T`                  | Current value from localStorage     |
| `setValue`   | `(value: T) => void` | Function to update the stored value |

### Type Definition

<Tabs items={['TypeScript', 'JavaScript']}>
<Tab value="TypeScript">
```tsx
function useLocalStorage<T>(
  key: string,
  initialValue: T
): [T, (value: T) => void];
```
</Tab>
<Tab value="JavaScript">
```jsx
function useLocalStorage(key, initialValue);
// Returns: [value, setValue]
```
</Tab>
</Tabs>

## Real-World Examples

### User Settings Dashboard

```tsx
import { useLocalStorage } from "./hooks/useLocalStorage";

interface AppSettings {
  language: "en" | "es" | "fr";
  theme: "light" | "dark" | "auto";
  sidebarCollapsed: boolean;
  autoSave: boolean;
}

function SettingsPanel() {
  const [settings, setSettings] = useLocalStorage<AppSettings>("appSettings", {
    language: "en",
    theme: "auto",
    sidebarCollapsed: false,
    autoSave: true,
  });

  const updateSetting = <K extends keyof AppSettings>(
    key: K,
    value: AppSettings[K]
  ) => {
    setSettings((prev) => ({ ...prev, [key]: value }));
  };

  return (
    <div className="settings-panel">
      <h2>Settings</h2>

      <div className="setting-group">
        <label>Language</label>
        <select
          value={settings.language}
          onChange={(e) =>
            updateSetting("language", e.target.value as AppSettings["language"])
          }
        >
          <option value="en">English</option>
          <option value="es">Español</option>
          <option value="fr">Français</option>
        </select>
      </div>

      <div className="setting-group">
        <label>Theme</label>
        <select
          value={settings.theme}
          onChange={(e) =>
            updateSetting("theme", e.target.value as AppSettings["theme"])
          }
        >
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="auto">Auto</option>
        </select>
      </div>

      <div className="setting-group">
        <label>
          <input
            type="checkbox"
            checked={settings.sidebarCollapsed}
            onChange={(e) =>
              updateSetting("sidebarCollapsed", e.target.checked)
            }
          />
          Collapse sidebar
        </label>
      </div>

      <div className="setting-group">
        <label>
          <input
            type="checkbox"
            checked={settings.autoSave}
            onChange={(e) => updateSetting("autoSave", e.target.checked)}
          />
          Auto-save changes
        </label>
      </div>
    </div>
  );
}
```

### Shopping Cart Persistence

```tsx
interface CartItem {
  id: string;
  name: string;
  price: number;
  quantity: number;
}

function ShoppingCart() {
  const [cart, setCart] = useLocalStorage<CartItem[]>("shoppingCart", []);

  const addToCart = (product: Omit<CartItem, "quantity">) => {
    setCart((prev) => {
      const existingItem = prev.find((item) => item.id === product.id);

      if (existingItem) {
        return prev.map((item) =>
          item.id === product.id
            ? { ...item, quantity: item.quantity + 1 }
            : item
        );
      }

      return [...prev, { ...product, quantity: 1 }];
    });
  };

  const removeFromCart = (productId: string) => {
    setCart((prev) => prev.filter((item) => item.id !== productId));
  };

  const updateQuantity = (productId: string, quantity: number) => {
    if (quantity <= 0) {
      removeFromCart(productId);
      return;
    }

    setCart((prev) =>
      prev.map((item) => (item.id === productId ? { ...item, quantity } : item))
    );
  };

  const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);

  return (
    <div className="shopping-cart">
      <h2>Shopping Cart ({cart.length} items)</h2>

      {cart.length === 0 ? (
        <p>Your cart is empty</p>
      ) : (
        <>
          {cart.map((item) => (
            <div key={item.id} className="cart-item">
              <span>{item.name}</span>
              <div className="quantity-controls">
                <button
                  onClick={() => updateQuantity(item.id, item.quantity - 1)}
                >
                  -
                </button>
                <span>{item.quantity}</span>
                <button
                  onClick={() => updateQuantity(item.id, item.quantity + 1)}
                >
                  +
                </button>
              </div>
              <span>${(item.price * item.quantity).toFixed(2)}</span>
              <button onClick={() => removeFromCart(item.id)}>Remove</button>
            </div>
          ))}

          <div className="cart-total">
            <strong>Total: ${total.toFixed(2)}</strong>
          </div>

          <button onClick={() => setCart([])}>Clear Cart</button>
        </>
      )}
    </div>
  );
}
```

## Best Practices

<Callout type="info" title="Performance Tips">
  - Use specific keys to avoid conflicts: `'userSettings'` instead of
  `'settings'` - Keep stored data reasonably sized (localStorage has ~5-10MB
  limit) - Consider using `useCallback` for update functions if passed to child
  components - For complex nested updates, consider using a reducer pattern
</Callout>

### Do's and Don'ts

**✅ Do:**

- Use descriptive, unique keys
- Provide sensible default values
- Handle the case where localStorage might not be available
- Use TypeScript for better type safety

**❌ Don't:**

- Store sensitive information (tokens, passwords)
- Store very large objects (use IndexedDB instead)
- Use generic keys that might conflict
- Forget that localStorage is synchronous

### Error Handling

The hook automatically handles localStorage failures:

```tsx
// If localStorage is unavailable (private browsing, etc.)
// the hook will fall back to regular state
const [value, setValue] = useLocalStorage("key", "default");
// Always works, even if localStorage fails
```

## Browser Support

- ✅ All modern browsers
- ✅ Internet Explorer 8+ (with JSON polyfill)
- ✅ React Native (with AsyncStorage polyfill)
- ✅ Server-side rendering (falls back to initial value)

## Related Hooks

- **useAsync** - For loading data that should be cached
- **useDebounce** - To debounce localStorage updates
- **useToggle** - For simple boolean localStorage values

## Migration Guide

### From useState

```tsx
// Before
const [theme, setTheme] = useState("light");

// After
const [theme, setTheme] = useLocalStorage("theme", "light");
```

### From Manual localStorage

```tsx
// Before
const [theme, setTheme] = useState(() => {
  try {
    const stored = localStorage.getItem("theme");
    return stored ? JSON.parse(stored) : "light";
  } catch {
    return "light";
  }
});

useEffect(() => {
  try {
    localStorage.setItem("theme", JSON.stringify(theme));
  } catch {
    // Handle error
  }
}, [theme]);

// After
const [theme, setTheme] = useLocalStorage("theme", "light");
```
````
